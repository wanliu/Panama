<% f = value_for(:form) %>

<% @product.properties.each do |prop| %>
    <% case prop.property_type %>
    <% when "string" %>
       <%= f.input prop.name,:label => prop.title %>
    <% when "integer" %>
       <%= f.input prop.name, :as => :number,:label => prop.title %>
    <% when "set" %>
       <% index = prop.items.find_index{|i| i.value == @product.send(prop.name) } || 0 %>
       <%= f.input prop.name, :as => :select,:collection => prop.items, :label => prop.title, :selected => index + 1 %>
    <% when "datetime" %>
       <%= f.input prop.name,
          :as => :date_choice,
          :title => "#{prop.title}",
          :name => "product[#{prop.name}]", 
          :value => "#{@product.send(prop.name)}" %>
    <% when "float" %>
       <%= f.input prop.name,:as => :float,:label => prop.title %>
    <% when "decimal" %>
       <%= f.input prop.name,:as => :decimal,:label => prop.title %>
    <% end %>
<% end %>
