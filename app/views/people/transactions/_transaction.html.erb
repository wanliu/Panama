<% seller = transaction.seller %>
<div id="order<%=transaction.id %>" class="transaction transaction-<%=transaction.id %>-<%= transaction.state %>"
   state-id="<%= transaction.id %>"
   state-initial="<%= transaction.state %>"
   state-url="<%= page_person_transaction_path(@people, transaction) %>"
   state-event-url= "<%= trigger_event_person_transaction_path(@people, transaction) %>"
   url-root="<%= person_transaction_path(@people, transaction) %>">
  <div class="wrapper-box">
    <div class="transaction-header">

      <div class="avatar">
        <%= image_tag seller.photos.header, :class => 'img-polaroid' %>
      </div>

      <div class="container-fluid info-header">
        <div class="page-header">
          <h1>
            <%= seller.name %>
            <small rel='tooltip' title="<%=I18n.l transaction.created_at, :format => :long %>">
              <%= time_ago_in_words transaction.created_at %>
              <span class="display-state"></span>
            </small>

            <button type="button" class="close" data-dismiss="alert">&times;</button>
            <%= render "state_buttons", :transaction => transaction %>
          </h1>
          <div class="state-progress">
            <div class="progress progress-mini progress-striped active">
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="transaction-body">
      <%= render state, transaction: transaction, people: people %>
    </div>
    <div class="transaction-footer">
      <div class="message-toggle"><%= button_tag icon(:list), :class => "btn" %></div>
      <iframe class="hide" name="transaction_<%=transaction.id %>" src="<%= dialogue_person_transaction_path(people, transaction) %>">
      </iframe>
    </div>
  </div>
</div>
<script type="text/javascript">
  require(["jquery", "lib/transaction_progress"], function($,TransactionProgress){
    new TransactionProgress({
      el: $("#order<%=transaction.id %> .state-progress>.progress"),
      state: "<%= transaction.state %>",
      localName: <%=t("order_states.buyer").to_json.html_safe %>
    })
  })
</script>