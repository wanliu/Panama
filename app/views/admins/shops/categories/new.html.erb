<tr <%= indent_attributes(@indent) %> >

	<td>
		<%= category_name_field @category %>
	</td>
	<td></td>
	<td></td>
	<td>
		<%= category_util_field @category %>
	</td>
</tr>
<%= simple_form_for @category, 
	:url => admins_categories(@category), 
	:remote => true,
	:html => {:id => @category.id } do |f| %>
	<%= text_field_tag :form_id, @category.id %>
	<%= text_field_tag :indent, @indent %>
	<%= f.input :name %>
<% end %>


<%= register_javascript :cancel_new_category_editor do %>
<script type="text/javascript">
	require(['jquery'], function($){

		function stringValue(name, value){
			return $input = $("<input type='text'  />").attr('name', name).val(value);
		}

		function getInlineValue(ele, name){
			var input = $(ele).parents("tr").find(":input[name="+ name + "]")
			return input.val();
		}

		$("#table .btn.utils.save").on('click', function(){
			var $form = $("#<%= @category.id %>");
			var $this = $(this);
			$.rails.handleRemote($form);

			$form.bind("ajax:before", function(){
				$form.find(":input[name='category[name]']").val(getInlineValue($this, "name"));
			});

			$form.submit(false);
		});



		$("#table .btn.utils.cancel").on('click', function(){
			var $tr = $(this).parents("tr");
			$tr.slideUp();

			$tr
				.promise()
				.done(function(){
					this.remove();
				})
		});
	});
</script>
<% end %>